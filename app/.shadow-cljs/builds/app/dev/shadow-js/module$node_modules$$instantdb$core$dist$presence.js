["^ ","~:resource-id",["~:shadow.build.npm/resource","node_modules/@instantdb/core/dist/presence.js"],"~:js","shadow$provide.module$node_modules$$instantdb$core$dist$presence = function(global, require, module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {value:!0});\n  exports.buildPresenceSlice = function(data, opts, userPeerId) {\n    var _a, _b;\n    const slice = {peers:{}};\n    if (opts && \"user\" in opts ? opts.user : 1) {\n      const user = (0,pick_1.pick)(null !== (_a = data.user) && void 0 !== _a ? _a : {}, null === opts || void 0 === opts ? void 0 : opts.keys);\n      slice.user = Object.assign(Object.assign({}, user), {peerId:userPeerId});\n    }\n    for (const id of Object.keys(null !== (_b = data.peers) && void 0 !== _b ? _b : {})) {\n      if (userPeerId = void 0 === (null === opts || void 0 === opts ? void 0 : opts.peers), _a = Array.isArray(null === opts || void 0 === opts ? void 0 : opts.peers) && (null === opts || void 0 === opts ? void 0 : opts.peers.includes(id)), userPeerId || _a) {\n        userPeerId = (0,pick_1.pick)(data.peers[id], null === opts || void 0 === opts ? void 0 : opts.keys), slice.peers[id] = Object.assign(Object.assign({}, userPeerId), {peerId:id});\n      }\n    }\n    return slice;\n  };\n  exports.hasPresenceResponseChanged = function(a, b) {\n    if (a.isLoading !== b.isLoading || a.error !== b.error) {\n      return !0;\n    }\n    if (a.user || b.user) {\n      if (!a.user || !b.user || !(0,object_1.areObjectsShallowEqual)(a.user, b.user)) {\n        return !0;\n      }\n    }\n    if (!(0,object_1.areObjectKeysEqual)(a.peers, b.peers)) {\n      return !0;\n    }\n    for (const id of Object.keys(a.peers)) {\n      if (!(0,object_1.areObjectsShallowEqual)(a.peers[id], b.peers[id])) {\n        return !0;\n      }\n    }\n    return !1;\n  };\n  const pick_1 = require(\"module$node_modules$$instantdb$core$dist$utils$pick\"), object_1 = require(\"module$node_modules$$instantdb$core$dist$utils$object\");\n};\n","~:source","shadow$provide[\"module$node_modules$$instantdb$core$dist$presence\"] = function(global,require,module,exports) {\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.buildPresenceSlice = buildPresenceSlice;\nexports.hasPresenceResponseChanged = hasPresenceResponseChanged;\nconst pick_1 = require(\"./utils/pick\");\nconst object_1 = require(\"./utils/object\");\nfunction buildPresenceSlice(data, opts, userPeerId) {\n    var _a, _b;\n    const slice = {\n        peers: {},\n    };\n    const includeUser = opts && 'user' in opts ? opts.user : true;\n    if (includeUser) {\n        const user = (0, pick_1.pick)((_a = data.user) !== null && _a !== void 0 ? _a : {}, opts === null || opts === void 0 ? void 0 : opts.keys);\n        slice.user = Object.assign(Object.assign({}, user), { peerId: userPeerId });\n    }\n    for (const id of Object.keys((_b = data.peers) !== null && _b !== void 0 ? _b : {})) {\n        const shouldIncludeAllPeers = (opts === null || opts === void 0 ? void 0 : opts.peers) === undefined;\n        const isPeerIncluded = Array.isArray(opts === null || opts === void 0 ? void 0 : opts.peers) && (opts === null || opts === void 0 ? void 0 : opts.peers.includes(id));\n        if (shouldIncludeAllPeers || isPeerIncluded) {\n            const peer = (0, pick_1.pick)(data.peers[id], opts === null || opts === void 0 ? void 0 : opts.keys);\n            slice.peers[id] = Object.assign(Object.assign({}, peer), { peerId: id });\n        }\n    }\n    return slice;\n}\n/**\n * Compare two presence slices\n * 0. compare isLoading and error\n * 1. shallow compare user\n * 2. compare peers keys\n * 3. shallow compare each peer\n */\nfunction hasPresenceResponseChanged(a, b) {\n    if (a.isLoading !== b.isLoading)\n        return true;\n    if (a.error !== b.error)\n        return true;\n    if (a.user || b.user) {\n        if (!a.user || !b.user)\n            return true;\n        const same = (0, object_1.areObjectsShallowEqual)(a.user, b.user);\n        if (!same)\n            return true;\n    }\n    const sameKeys = (0, object_1.areObjectKeysEqual)(a.peers, b.peers);\n    if (!sameKeys)\n        return true;\n    for (const id of Object.keys(a.peers)) {\n        const same = (0, object_1.areObjectsShallowEqual)(a.peers[id], b.peers[id]);\n        if (!same)\n            return true;\n    }\n    return false;\n}\n//# sourceMappingURL=presence.js.map\n};","~:removed-requires",["~#set",[]],"~:actual-requires",["^5",["~$shadow.js","~$module$node_modules$$instantdb$core$dist$utils$object","~$module$node_modules$$instantdb$core$dist$utils$pick"]],"~:properties",["^5",["user","peerId","__esModule","peers","buildPresenceSlice","value","hasPresenceResponseChanged"]],"~:compiled-at",1756239699975,"~:source-map-json","{\n\"version\":3,\n\"file\":\"module$node_modules$$instantdb$core$dist$presence.js\",\n\"lineCount\":38,\n\"mappings\":\"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\",\n\"sources\":[\"node_modules/@instantdb/core/dist/presence.js\"],\n\"sourcesContent\":[\"shadow$provide[\\\"module$node_modules$$instantdb$core$dist$presence\\\"] = function(global,require,module,exports) {\\n\\\"use strict\\\";\\nObject.defineProperty(exports, \\\"__esModule\\\", { value: true });\\nexports.buildPresenceSlice = buildPresenceSlice;\\nexports.hasPresenceResponseChanged = hasPresenceResponseChanged;\\nconst pick_1 = require(\\\"./utils/pick\\\");\\nconst object_1 = require(\\\"./utils/object\\\");\\nfunction buildPresenceSlice(data, opts, userPeerId) {\\n    var _a, _b;\\n    const slice = {\\n        peers: {},\\n    };\\n    const includeUser = opts && 'user' in opts ? opts.user : true;\\n    if (includeUser) {\\n        const user = (0, pick_1.pick)((_a = data.user) !== null && _a !== void 0 ? _a : {}, opts === null || opts === void 0 ? void 0 : opts.keys);\\n        slice.user = Object.assign(Object.assign({}, user), { peerId: userPeerId });\\n    }\\n    for (const id of Object.keys((_b = data.peers) !== null && _b !== void 0 ? _b : {})) {\\n        const shouldIncludeAllPeers = (opts === null || opts === void 0 ? void 0 : opts.peers) === undefined;\\n        const isPeerIncluded = Array.isArray(opts === null || opts === void 0 ? void 0 : opts.peers) && (opts === null || opts === void 0 ? void 0 : opts.peers.includes(id));\\n        if (shouldIncludeAllPeers || isPeerIncluded) {\\n            const peer = (0, pick_1.pick)(data.peers[id], opts === null || opts === void 0 ? void 0 : opts.keys);\\n            slice.peers[id] = Object.assign(Object.assign({}, peer), { peerId: id });\\n        }\\n    }\\n    return slice;\\n}\\n/**\\n * Compare two presence slices\\n * 0. compare isLoading and error\\n * 1. shallow compare user\\n * 2. compare peers keys\\n * 3. shallow compare each peer\\n */\\nfunction hasPresenceResponseChanged(a, b) {\\n    if (a.isLoading !== b.isLoading)\\n        return true;\\n    if (a.error !== b.error)\\n        return true;\\n    if (a.user || b.user) {\\n        if (!a.user || !b.user)\\n            return true;\\n        const same = (0, object_1.areObjectsShallowEqual)(a.user, b.user);\\n        if (!same)\\n            return true;\\n    }\\n    const sameKeys = (0, object_1.areObjectKeysEqual)(a.peers, b.peers);\\n    if (!sameKeys)\\n        return true;\\n    for (const id of Object.keys(a.peers)) {\\n        const same = (0, object_1.areObjectsShallowEqual)(a.peers[id], b.peers[id]);\\n        if (!same)\\n            return true;\\n    }\\n    return false;\\n}\\n//# sourceMappingURL=presence.js.map\\n};\"],\n\"names\":[\"shadow$provide\",\"global\",\"require\",\"module\",\"exports\",\"Object\",\"defineProperty\",\"value\",\"buildPresenceSlice\",\"data\",\"opts\",\"userPeerId\",\"_a\",\"_b\",\"slice\",\"peers\",\"includeUser\",\"user\",\"pick_1\",\"pick\",\"keys\",\"assign\",\"peerId\",\"id\",\"shouldIncludeAllPeers\",\"undefined\",\"isPeerIncluded\",\"Array\",\"isArray\",\"includes\",\"peer\",\"hasPresenceResponseChanged\",\"a\",\"b\",\"isLoading\",\"error\",\"same\",\"object_1\",\"areObjectsShallowEqual\",\"sameKeys\",\"areObjectKeysEqual\"]\n}\n"]